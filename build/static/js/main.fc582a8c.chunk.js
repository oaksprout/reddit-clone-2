(this["webpackJsonpReddit-Clone-2"]=this["webpackJsonpReddit-Clone-2"]||[]).push([[0],{13:function(e,t,a){e.exports=a.p+"static/media/link.204212aa.png"},14:function(e,t,a){e.exports=a.p+"static/media/speech-bubble.c9ad79f6.jpg"},47:function(e,t,a){e.exports=a(70)},52:function(e,t,a){},70:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(31),s=a.n(c),i=(a(52),a(5)),l=a(10),o=a(27),m=a.n(o);m.a.initializeApp({apiKey:"AIzaSyCb52WtWB7I14uzj2WqKPUqgf3eAeL_cS0",authDomain:"offerings-aa4ae.firebaseapp.com",projectId:"offerings-aa4ae",storageBucket:"offerings-aa4ae.appspot.com",messagingSenderId:"667282666621",appId:"1:667282666621:web:14610c4000519f7f802d14",measurementId:"G-T9KNQX3N8Q"});var u=m.a,d=a(4),p=a(6),f=a(2),v=a(3),b=a.n(v),E=a(7),h=u.firestore();h.settings({});var g=h,N=function(){return function(){var e=Object(E.a)(b.a.mark((function e(t){var a,n,r,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=new u.auth.TwitterAuthProvider,e.next=4,u.auth().signInWithPopup(a);case 4:n=e.sent,r=n.user,c={name:r.displayName,id:r.uid,image:r.photoURL},s=Object(f.a)(Object(f.a)({},c),{},{created_at:u.firestore.FieldValue.serverTimestamp()}),g.collection("users").doc(s.id).set(s),t({type:"LOGIN_USER",payload:c}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.error(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()},O=function(){return function(){var e=Object(E.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=[],e.next=4,g.collection("subreddits").get();case 4:e.sent.forEach((function(e){a.push(e.data())})),t({type:"GET_SUBREDDITS",payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},_=a(45),y=Object(p.b)((function(e){return{auth:e.auth,subreddits:e.subreddits}}),{login:N,logout:function(){return function(){var e=Object(E.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.auth().signOut();case 3:t({type:"LOGOUT_USER"}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},fetchSubreddits:O})((function(e){var t=e.login,a=e.logout,c=e.fetchSubreddits,s=(e.subreddits.subreddits,e.auth),l=s.currentUser,o=s.isLoggedIn;Object(n.useEffect)((function(){c()}),[c]);var m=Object(n.useState)(!1),u=Object(d.a)(m,2);u[0],u[1];return r.a.createElement("nav",{className:"navbar is-primary",role:"navigation","aria-label":"dropdown navigation"},r.a.createElement("div",{className:"navbar-brand"},r.a.createElement(i.b,{className:"navbar-item",style:{fontSize:20},to:"/"},r.a.createElement("span",{style:{fontFamily:"Liu Jian Mao Cao",marginRight:10}},"\u8840")," Blood Ledger")),r.a.createElement("div",{id:"navbarBasicExample",className:"navbar-menu is-primary"},r.a.createElement("div",{className:"navbar-end"},o?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"navbar-item"},r.a.createElement(i.b,{to:"/u/".concat(l.id),className:"button is-light is-info"},l.name)),r.a.createElement("div",{className:"navbar-item"},r.a.createElement("button",{className:"button is-primary",onClick:function(){return a()}},"Logout"))):r.a.createElement("div",{className:"navbar-item"},r.a.createElement("button",{className:"button is-white is-outline",onClick:function(){return t()}},r.a.createElement(_.a,{style:{marginRight:10}}),"Sign In")))))})),j=function(){return r.a.createElement("header",null,r.a.createElement(y,null))},x=Object(p.b)((function(e){return{auth:e.auth}}),null)((function(e){var t=e.auth;t.isLoggedIn,t.currentUser;return r.a.createElement("footer",{className:"footer"},r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column mid-column has-text-centered"},r.a.createElement("p",null,"\xa9",(new Date).getFullYear()," ",r.a.createElement("a",{href:"http://www.twitter.com/tannedoaksprout",rel:"noopener noreferrer",target:"_blank"},"Oaksprout the Tan")))))})),w=a(46),C=Object(p.b)((function(e){return{auth:e.auth}}),null)((function(e){var t=e.component,a=e.auth,n=a.isLoggedIn,c=a.isLoading,s=Object(w.a)(e,["component","auth"]);return r.a.createElement(l.b,Object.assign({},s,{render:function(e){return!n&&c?r.a.createElement(l.a,{to:"/"}):r.a.createElement(t,e)}}))})),k=function(e){var t=e.large,a=e.medium,n=e.color,c=e.children;return r.a.createElement("div",{className:"hero\n        ".concat("yellow"===n&&"is-warning","\n        ").concat("green"===n&&"is-success","\n        ").concat("lightblue"===n&&"is-info","\n        ").concat("darkblue"===n&&"is-link","\n        ").concat("light"===n&&"is-light","\n        ").concat("dark"===n&&"is-dark","\n        ").concat("teal"===n&&"is-primary","\n        ").concat(t&&"is-large","\n        ").concat(a&&"is-medium","\n      ")},c)},U=a(20),S=function(e){return r.a.createElement("div",{className:"container my-5"},e.children)},T=function(e){e*=1e3;var t=Math.floor((new Date-e)/1e3),a=Math.floor(t/31536e3);return a>1?"".concat(a," years"):(a=Math.floor(t/2592e3))>1?"".concat(a," months"):(a=Math.floor(t/86400))>0?"".concat(a," days"):(a=Math.floor(t/3600))>1?"".concat(a," hours"):(a=Math.floor(t/60))>1?"".concat(a," minutes"):"".concat(isNaN(Math.floor(t))?"0":Math.floor(t)," seconds")},R=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id";return e.filter((function(e){return e[a]===t}))[0]},L=function(e){var t=e.slice(0,140).trim();return t.length>139?"".concat(t,"..."):t},D=a(13),P=a.n(D),I=a(14),V=a.n(I),A=a(41),F=a.n(A),M=a(42),G=a.n(M),z=function(e){var t=e.children;return r.a.createElement("div",{dangerouslySetInnerHTML:{__html:G.a.sanitize(F()(t))}})},B=function(){return function(){var e=Object(E.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=[],e.next=4,g.collection("votes").get();case 4:e.sent.forEach((function(e){a.push(e.data())})),t({type:"GET_VOTES",payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},H=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(){var r=Object(E.a)(b.a.mark((function r(c){var s,i;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={userUpvoted:!1,userDownvoted:!1},r.prev=1,r.next=4,g.collection("votes").where("post_id","==",t).where("user_upvotes","array-contains",a).get();case 4:return r.sent.forEach((function(e){e&&(i.userUpvoted=!0)})),r.next=8,g.collection("votes").where("post_id","==",t).where("user_downvotes","array-contains",a).get();case 8:if(r.sent.forEach((function(e){e&&(i.userDownvoted=!0)})),!i.userUpvoted){r.next=15;break}return r.next=13,g.collection("votes").doc(e).update({user_upvotes:u.firestore.FieldValue.arrayRemove(a),updated_at:u.firestore.FieldValue.serverTimestamp(),votes:u.firestore.FieldValue.increment(-1)});case 13:r.next=22;break;case 15:if(!i.userDownvoted){r.next=20;break}return r.next=18,g.collection("votes").doc(e).update({user_upvotes:u.firestore.FieldValue.arrayUnion(a),user_downvotes:u.firestore.FieldValue.arrayRemove(a),updated_at:u.firestore.FieldValue.serverTimestamp(),votes:u.firestore.FieldValue.increment(2)});case 18:r.next=22;break;case 20:return r.next=22,g.collection("votes").doc(e).update({user_upvotes:u.firestore.FieldValue.arrayUnion(a),updated_at:u.firestore.FieldValue.serverTimestamp(),votes:u.firestore.FieldValue.increment(1)});case 22:return r.next=24,g.collection("votes").doc(e).get().then((function(e){s=e.data()}));case 24:n&&(c({type:"CLEAR_VOTE"}),c({type:"GET_VOTE",payload:s})),c({type:"ADD_VOTE",payload:s}),r.next=31;break;case 28:r.prev=28,r.t0=r.catch(1),console.error(r.t0.message);case 31:case"end":return r.stop()}}),r,null,[[1,28]])})));return function(e){return r.apply(this,arguments)}}()},X=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(){var r=Object(E.a)(b.a.mark((function r(c){var s,i;return b.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={userUpvoted:!1,userDownvoted:!1},r.prev=1,r.next=4,g.collection("votes").where("post_id","==",t).where("user_upvotes","array-contains",a).get();case 4:return r.sent.forEach((function(e){e&&(i.userUpvoted=!0)})),r.next=8,g.collection("votes").where("post_id","==",t).where("user_downvotes","array-contains",a).get();case 8:if(r.sent.forEach((function(e){e&&(i.userDownvoted=!0)})),!i.userUpvoted){r.next=15;break}return r.next=13,g.collection("votes").doc(e).update({user_upvotes:u.firestore.FieldValue.arrayRemove(a),user_downvotes:u.firestore.FieldValue.arrayUnion(a),updated_at:u.firestore.FieldValue.serverTimestamp(),votes:u.firestore.FieldValue.increment(-2)});case 13:r.next=22;break;case 15:if(!i.userDownvoted){r.next=20;break}return r.next=18,g.collection("votes").doc(e).update({user_downvotes:u.firestore.FieldValue.arrayRemove(a),updated_at:u.firestore.FieldValue.serverTimestamp(),votes:u.firestore.FieldValue.increment(1)});case 18:r.next=22;break;case 20:return r.next=22,g.collection("votes").doc(e).update({user_downvotes:u.firestore.FieldValue.arrayUnion(a),updated_at:u.firestore.FieldValue.serverTimestamp(),votes:u.firestore.FieldValue.increment(-1)});case 22:return r.next=24,g.collection("votes").doc(e).get().then((function(e){s=e.data()}));case 24:n&&(c({type:"CLEAR_VOTE"}),c({type:"GET_VOTE",payload:s})),c({type:"REMOVE_VOTE",payload:s}),r.next=31;break;case 28:r.prev=28,r.t0=r.catch(1),console.error(r.t0.message);case 31:case"end":return r.stop()}}),r,null,[[1,28]])})));return function(e){return r.apply(this,arguments)}}()},W=Object(p.b)(null,{upvote:H,downvote:X})((function(e){var t=e.postId,a=e.voteId,n=e.upvote,c=e.downvote,s=e.votes,i=e.userUpvotes,l=e.userDownvotes,o=e.currentUser,m=a,u=t,d=o.id;return r.a.createElement("div",{className:"votes"},r.a.createElement("button",{className:"button is-success is-small ".concat(-1!==i.indexOf(o.id)&&"is-light"),disabled:0===Object.entries(o).length,onClick:function(){return n(m,u,d)}},"Upvote"),r.a.createElement("span",{className:"vote-amount my-1"},s),r.a.createElement("button",{className:"button is-danger is-small ".concat(-1!==l.indexOf(o.id)&&"is-light"),disabled:0===Object.entries(o).length,onClick:function(){return c(m,u,d)}},"Downvote"))})),Y=function(e){var t,a,n=e.post,c=e.users,s=e.votes,l=e.currentUser,o=e.subreddits,m=R(c,n.user_id),u=R(o,n.subreddit_id),d=R(s,n.id,"post_id");return""!==n.image?(t=n.image,a=n.image):""!==n.fileRef?(t=n.fileRef,a=n.fileRef):""!==n.url?(t=P.a,a=n.url):(t=V.a,a="/r/".concat(u.name,"/").concat(n.id)),r.a.createElement("div",{className:"my-6 media"},void 0!==d&&r.a.createElement("div",{className:"media-left align-center"},r.a.createElement(W,{voteId:d.id,postId:d.post_id,votes:d.votes,userUpvotes:d.user_upvotes,userDownvotes:d.user_downvotes,currentUser:l})),r.a.createElement("div",{className:"media-image media-left align-center"},r.a.createElement("a",{href:a,rel:"noopener noreferrer",target:"_blank"},r.a.createElement("figure",{className:"image is-128x128 center-image border-image"},r.a.createElement("img",{src:t,alt:""})))),r.a.createElement("div",{className:"media-content post-content"},r.a.createElement("p",null,u&&r.a.createElement(i.b,{to:"/r/".concat(u.name,"/").concat(n.id)},n.title)),n.desc&&r.a.createElement("div",{className:"mb-3"},r.a.createElement(z,null,L(n.desc))),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-item has-text-centered is-size-7"},"Created ",T(n.created_at.seconds)),r.a.createElement("div",{className:"level-item has-text-centered is-size-7"},"Updated ",T(n.updated_at.seconds)),r.a.createElement("div",{className:"level-item has-text-centered is-size-7"},m&&r.a.createElement(i.b,{to:"/u/".concat(m.id)},m.name)),r.a.createElement("div",{className:"level-item has-text-centered is-size-7"},u&&r.a.createElement(i.b,{to:"/r/".concat(u.name)},u.name)))))},q=function(e){var t,a=e.lastIndexOf("/");if(-1===a)throw Error;var n=e.slice(a+1);return-1!==n.indexOf("?")?(t=n.indexOf("?"),n.slice(0,t)):n},J=m.a.storage(),K=function(){return function(){var e=Object(E.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.prev=1,t({type:"CLEAR_POSTS"}),e.next=5,g.collection("posts").get();case 5:e.sent.forEach((function(e){a.push(e.data())})),a=a.sort((function(e,t){return t.created_at-e.created_at})),t({type:"GET_POSTS",payload:a}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0.message);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}()},Q=function(e,t){return function(){var a=Object(E.a)(b.a.mark((function a(n){var r,c,s,i;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,g.collection("comments").where("post_id","==",e).get().then((function(e){var t=g.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 3:return a.next=5,g.collection("posts").doc(e).get().then((function(e){r=e.data().fileRef}));case 5:if(""===r){a.next=11;break}return c=J.ref(),s=q(r),i=c.child(s),a.next=11,i.delete();case 11:return a.next=13,g.collection("posts").doc(e).delete();case 13:return n({type:"DELETE_POST",payload:e}),a.next=16,g.collection("votes").where("post_id","==",e).get().then((function(e){var t=g.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 16:n({type:"DELETE_VOTE",payload:t}),a.next=22;break;case 19:a.prev=19,a.t0=a.catch(0),console.error(a.t0.message);case 22:case"end":return a.stop()}}),a,null,[[0,19]])})));return function(e){return a.apply(this,arguments)}}()},$=Object(p.b)(null,{upvote:H,downvote:X,deletePost:Q})((function(e){var t,a,n=e.post,c=e.users,s=e.votes,l=e.currentUser,o=e.subreddits,m=R(c,n.user_id),u=R(o,n.subreddit_id),d=R(s,n.id);return""!==n.image?(t=n.image,a=n.image):""!==n.fileRef?(t=n.fileRef,a=n.fileRef):""!==n.url?(t=P.a,a=n.url):(t=V.a,a="/r/".concat(u.name,"/").concat(n.id)),r.a.createElement("div",{className:"my-6 card mobile-card"},r.a.createElement("div",{className:"card-image"},r.a.createElement("figure",{className:"image is-4by3"},r.a.createElement("a",{href:a,rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{src:t,alt:""})))),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image is-48x48"},void 0!==m&&r.a.createElement("img",{src:m.image,alt:""}))),r.a.createElement("div",{className:"media-content"},r.a.createElement(i.b,{to:"/r/".concat(u.name,"/").concat(n.id)},r.a.createElement("p",{className:"title is-6"},n.title)),void 0!==m&&r.a.createElement(i.b,{to:"/u/".concat(m.id)},r.a.createElement("p",{className:"subtitle is-7"},m.name)))),r.a.createElement("div",{className:"content"},n.desc&&r.a.createElement("div",{className:"mb-3"},r.a.createElement(z,null,L(n.desc))),r.a.createElement("p",{className:"is-size-7 mb-0"},u&&r.a.createElement(i.b,{to:"/r/".concat(u.name)},u.name)),r.a.createElement("p",{className:"is-size-7 mt-0 mb-0"},"Created ",T(n.created_at.seconds)),r.a.createElement("p",{className:"is-size-7 mt-0"},"Updated ",T(n.updated_at.seconds)))),l.id===n.user_id&&r.a.createElement("button",{className:"delete-button",onClick:function(){return Q(n.id,d.id)}},"X"),void 0!==d&&r.a.createElement("div",{className:"card-footer"},r.a.createElement("div",{className:"card-footer-item"},r.a.createElement("button",{className:"button is-success is-small ".concat(-1!==d.user_upvotes.indexOf(l.id)&&"is-light"),disabled:0===Object.entries(l).length,onClick:function(){return H(d.id,n.id,l.id)}},"Upvote")),r.a.createElement("div",{className:"card-footer-item"},r.a.createElement("span",{className:"vote-amount my-1"},d.votes)),r.a.createElement("div",{className:"card-footer-item"},r.a.createElement("button",{className:"button is-danger is-small ".concat(-1!==d.user_downvotes.indexOf(l.id)&&"is-light"),disabled:0===Object.entries(l).length,onClick:function(){return X(d.id,n.id,l.id)}},"Downvote"))))})),Z=function(e){var t=e.posts,a=e.users,n=e.subreddits,c=e.currentUser,s=e.votes;return r.a.createElement(S,null,r.a.createElement("h1",{className:"has-text-centered is-title"},"Check out the latest posts"),0!==t.length&&t.map((function(e){return U.isMobile?r.a.createElement($,{key:e.id,post:e,users:a,subreddits:n,votes:s,currentUser:c}):r.a.createElement(Y,{key:e.id,post:e,users:a,subreddits:n,votes:s,currentUser:c})})))},ee=function(){return function(){var e=Object(E.a)(b.a.mark((function e(t){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.prev=1,e.next=4,g.collection("users").get();case 4:e.sent.forEach((function(e){a.push(e.data())})),t({type:"GET_USERS",payload:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},te=Object(p.b)((function(e){return{auth:e.auth,posts:e.posts,users:e.users,subreddits:e.subreddits,votes:e.votes}}),{login:N,fetchVotes:B,fetchAllPosts:K,fetchSubreddits:O,fetchUsers:ee})((function(e){var t=e.login,a=e.fetchAllPosts,c=e.fetchSubreddits,s=e.fetchVotes,i=e.fetchUsers,l=e.posts.posts,o=e.auth,m=o.currentUser,u=o.isLoggedIn,d=e.users.users,p=e.subreddits.subreddits,f=e.votes.votes;return Object(n.useEffect)((function(){a(),c(),i(),s()}),[a,c,i,s]),r.a.createElement("section",null,r.a.createElement(k,{color:"lightblue",large:!0},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"title"},"Reggit"),r.a.createElement("h2",{className:"subtitle"},"Welcome to the front page of Dave Regg's internet!"),!u&&r.a.createElement("button",{className:"button is-outlined",onClick:function(){return t()}},"Login")))),r.a.createElement(Z,{posts:l.slice(0,25),users:d,subreddits:p,votes:f,currentUser:m}))})),ae=function(e){var t,a,n=e.deletePost,c=e.currentUser,s=e.subreddit,l=e.post,o=e.author,m=e.postVotes,u=m.voteId,d=m.userUpvotes,p=m.userDownvotes,f=m.votes,v=u,b=l.id;return""!==l.image?(t=l.image,a=l.image):""!==l.fileRef?(t=l.fileRef,a=l.fileRef):""!==l.url?(t=P.a,a=l.url):(t=V.a,a="/r/".concat(s,"/").concat(l.id)),r.a.createElement("div",{className:"media",key:b},r.a.createElement("div",{className:"media-left align-center"},r.a.createElement(W,{voteId:v,postId:b,votes:f,userUpvotes:d,userDownvotes:p,currentUser:c})),r.a.createElement("div",{className:"media-left align-center"},r.a.createElement("a",{href:a,rel:"noopener noreferrer",target:"_blank"},r.a.createElement("figure",{className:"image is-128x128 center-image border-image"},r.a.createElement("img",{src:t,alt:""})))),r.a.createElement("div",{className:"media-content post-content"},r.a.createElement("p",{className:"has-text-weight-bold"},r.a.createElement(i.b,{to:"/r/".concat(s,"/").concat(b)},r.a.createElement("div",{className:"post-title"},l.title))),""!==l.desc&&r.a.createElement("div",{className:"mb-3"},r.a.createElement(z,null,L(l.desc))),r.a.createElement("div",{className:"level is-size-7"},r.a.createElement("div",{className:"level-right"},r.a.createElement("div",{className:"level-item"},r.a.createElement("span",{className:"has-text-weight-bold mr-1"},"Updated:")," ",T(l.updated_at.seconds)),r.a.createElement("div",{className:"level-item"},r.a.createElement("figure",{className:"image is-24x24 mr-2 mb-0"},r.a.createElement("img",{className:"is-rounded",src:o.image,alt:""})),r.a.createElement(i.b,{to:"/u/".concat(o.id)},o.name))))),l.user_id===c.id&&r.a.createElement("div",{className:"media-right"},r.a.createElement("button",{className:"delete",onClick:function(){return n(b,v)}},"X")))},ne=function(e){var t=e.search,a=e.subreddit,c=e.deletePost,s=e.currentUser,i=e.subreddits,l=e.users,o=e.votes,m=e.posts,u=Object(n.useState)(!1),p=Object(d.a)(u,2),f=p[0],v=p[1],b=Object(n.useState)(!0),E=Object(d.a)(b,2),h=E[0],g=E[1],N=function(e){return l.filter((function(t){return t.id===e}))[0]},O=function(e){return o.filter((function(t){return t.post_id===e}))[0]},_=function(e){return m.filter((function(t){return t.id===e}))[0]};return r.a.createElement("section",null,r.a.createElement("div",{className:"buttons mb-5"},r.a.createElement("button",{className:"mr-3 is-small button is-primary ".concat(f&&"is-light"),onClick:function(){return v(!0),void g(!1)},disabled:f},"Sort By Most Votes"),r.a.createElement("button",{className:"ml-5 is-small button is-primary ".concat(h&&"is-light"),onClick:function(){return g(!0),void v(!1)},disabled:h},"Sort By New")),r.a.createElement("div",null,m?f?function(e){return e.map((function(e){return O(e.id)})).sort((function(e,t){return t.votes-e.votes})).map((function(e){return e?_(e.post_id):null}))}(m).map((function(e){var t={voteId:"",userUpvotes:[],userDownvotes:[],votes:0};t.voteId=void 0!==O(e.id)&&O(e.id).id,t.votes=void 0!==O(e.id)?O(e.id).votes:"0",t.userUpvotes=void 0!==O(e.id)?O(e.id).user_upvotes:[],t.userDownvotes=void 0!==O(e.id)?O(e.id).user_downvotes:[];var n=void 0!==N(e.user_id)?N(e.user_id):{name:"Anonymous",image:"https://bulma.io/images/placeholders/96x96.png",id:"rand0mnumb3rgen3r4t0r"};return U.isMobile?r.a.createElement($,{key:e.id,post:e,users:l,subreddits:i,votes:o,currentUser:s}):r.a.createElement(ae,{key:e.id,currentUser:s,post:e,subreddit:a,author:n,postVotes:t})})):function(e){if(""!==t){var a=new RegExp(t,"gi");return e.filter((function(e){return(e.title+e.desc).match(a)}))}return e}(m).map((function(e){var t={voteId:"",userUpvotes:[],userDownvotes:[],votes:0};t.voteId=void 0!==O(e.id)&&O(e.id).id,t.votes=void 0!==O(e.id)?O(e.id).votes:"0",t.userUpvotes=void 0!==O(e.id)?O(e.id).user_upvotes:[],t.userDownvotes=void 0!==O(e.id)?O(e.id).user_downvotes:[];var n=void 0!==N(e.user_id)?N(e.user_id):{name:"Anonymous",image:"https://bulma.io/images/placeholders/96x96.png"};return U.isMobile?r.a.createElement($,{key:e.id,post:e,users:l,subreddits:i,votes:o,currentUser:s}):r.a.createElement(ae,{key:e.id,deletePost:c,currentUser:s,subreddit:a,post:e,author:n,postVotes:t})})):r.a.createElement("h1",null,"Loading")))},re=a(16),ce=function(e){return e.match(/(png|jpg|jpeg|gif|svg)$/)},se=function(e){var t=Object(n.useState)(0),a=Object(d.a)(t,2),r=a[0],c=a[1],s=Object(n.useState)(null),i=Object(d.a)(s,2),l=i[0],o=i[1],m=Object(n.useState)(null),u=Object(d.a)(m,2),p=u[0],f=u[1];return Object(n.useEffect)((function(){var t=J.ref(e.name);t.put(e).on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;c(t)}),(function(e){o(e)}),Object(E.a)(b.a.mark((function e(){var a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getDownloadURL();case 2:a=e.sent,f(a);case 4:case"end":return e.stop()}}),e)}))))}),[e]),{progress:r,url:p,error:l}},ie=function(e){var t=e.file,a=e.input,c=e.setInput,s=e.setImageFile,i=se(t),l=i.url,o=i.progress;return Object(n.useEffect)((function(){l&&(c(Object(f.a)(Object(f.a)({},a),{},{fileRef:l})),s(null))}),[l,a,c,s]),r.a.createElement("div",{style:{width:o+"%",height:"7px",backgroundColor:"pink"}})},le=Object(p.b)(null,{createPost:function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n,r,c,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=g.collection("posts").doc(),r=g.collection("votes").doc(),(c=Object(f.a)({},e)).id=n.id,c.created_at=u.firestore.FieldValue.serverTimestamp(),c.updated_at=u.firestore.FieldValue.serverTimestamp(),c.user_id=u.auth().currentUser.uid,(s={votes:1}).user_upvotes=[],s.user_downvotes=[],s.id=r.id,s.subreddit_id=c.subreddit_id,s.updated_at=u.firestore.FieldValue.serverTimestamp(),s.user_upvotes.push(u.auth().currentUser.uid),s.post_id=c.id,t.prev=15,t.next=18,g.collection("posts").doc(c.id).set(c);case 18:return t.next=20,g.collection("votes").doc(s.id).set(s);case 20:a({type:"CREATE_POST",payload:c}),a({type:"ADD_VOTES",payload:s}),a({}),t.next=28;break;case 25:t.prev=25,t.t0=t.catch(15),console.error(t.t0.message);case 28:case"end":return t.stop()}}),t,null,[[15,25]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.createPost,a=e.toggleShowForm,c=e.subreddit,s=Object(n.useState)({title:"",desc:"",image:"",url:"",fileRef:""}),i=Object(d.a)(s,2),l=i[0],o=i[1],m=l.title,u=l.desc,p=l.image,v=l.url,b=l.fileRef,E=Object(n.useState)(null),h=Object(d.a)(E,2),g=h[0],N=h[1],O=Object(n.useState)(!1),_=Object(d.a)(O,2),y=_[0],j=_[1],x=Object(n.useState)(!1),w=Object(d.a)(x,2),C=w[0],k=w[1],U=function(e){o(Object(f.a)(Object(f.a)({},l),{},Object(re.a)({},e.target.name,e.target.value)))};return r.a.createElement("div",{className:"columns"},r.a.createElement("div",{className:"column is-three-fifths"},r.a.createElement("div",{className:"panel"},r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault();var n,r=p,s=v,i=b;if(""!==b){var l=q(b);n=J.ref().child(l)}""!==r&&(ce(r)?(s="",i="",""!==b&&n.delete()):(s=r,i="",""!==b&&n.delete())),""!==s&&(i="",r="",""!==b&&n.delete()),""!==i&&(r="",s="");var d={title:m,desc:u,image:r,url:s,fileRef:i,subreddit_id:c.id};t(d),o({title:"",desc:"",url:"",image:"",file:null}),a(!1)}(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"Title",type:"text",value:m,name:"title",required:!0,onChange:function(e){return U(e)}}))),r.a.createElement("button",{type:"button",className:"button is-info is-small mb-3",onClick:function(){return k(!C)}},C?"Hide Preview":"Preview Description"),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},C?r.a.createElement("div",{className:"preview-markdown"},r.a.createElement(z,null,u)):r.a.createElement("textarea",{className:"textarea",placeholder:"Desc",type:"text",value:u,name:"desc",onChange:function(e){return U(e)}}))),r.a.createElement("button",{type:"button",className:"button is-small mb-3 is-link",onClick:function(){return j(!y)}},y?"Add URL":"Upload Image"),y?r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{disabled:0!==v.length||0!==p.length,type:"file",onChange:function(e){return function(e){var t=e.target.files[0];t&&ce(t.type)&&N(t)}(e)}}),r.a.createElement("div",null,g&&r.a.createElement(ie,{file:g,setImageFile:N,input:l,setInput:o}))),r.a.createElement("p",{className:"help"},"You will ",r.a.createElement("span",{className:"has-text-weight-bold"},"delete")," your upload if you add a URL.")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"URL",type:"text",value:v,name:"url",onChange:function(e){return U(e)},disabled:0!==p.length})),r.a.createElement("p",{className:"help"},"You may only link to an image ",r.a.createElement("span",{className:"has-text-weight-bold"},"or")," a website")),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"Image",type:"text",value:p,name:"image",onChange:function(e){return U(e)},disabled:0!==v.length})),r.a.createElement("p",{className:"help"},"You may only link to an image ",r.a.createElement("span",{className:"has-text-weight-bold"},"or")," a website"))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary",disabled:g},"Create Post"))))))})),oe=Object(p.b)((function(e){return{subreddits:e.subreddits,posts:e.posts,users:e.users,votes:e.votes,auth:e.auth}}),{deletePost:Q,deleteSubreddit:function(e,t){return function(){var a=Object(E.a)(b.a.mark((function a(n){return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!window.confirm("Are you sure? This action cannot be undone!")){a.next=17;break}return a.prev=1,a.next=4,g.collection("posts").where("subreddit_id","==",e).get().then((function(e){var t=g.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 4:return a.next=6,g.collection("votes").where("subreddit_id","==",e).get().then((function(e){var t=g.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 6:return a.next=8,g.collection("comments").where("subreddit_id","==",e).get().then((function(e){var t=g.batch();return e.forEach((function(e){t.delete(e.ref)})),t.commit()}));case 8:return a.next=10,g.collection("subreddits").doc(e).delete();case 10:n({type:"DELETE_SUBREDDIT",payload:e}),t.push("/"),a.next=17;break;case 14:a.prev=14,a.t0=a.catch(1),console.error(a.t0.message);case 17:case"end":return a.stop()}}),a,null,[[1,14]])})));return function(e){return a.apply(this,arguments)}}()},fetchUsers:ee,fetchVotes:B,fetchSubredditPosts:function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"CLEAR_POSTS"}),n=[],t.next=5,g.collection("posts").where("subreddit_id","==",e).get();case 5:t.sent.forEach((function(e){n.push(e.data())})),n=n.sort((function(e,t){return t.created_at-e.created_at})),a({type:"GET_POSTS",payload:n}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},fetchSubreddits:O,fetchSubreddit:function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"CLEAR_SUBREDDIT"}),n=e.name,t.prev=2,r={},t.next=6,g.collection("subreddits").where("name","==",n).get();case 6:t.sent.forEach((function(e){r=Object(f.a)({},e.data())})),a({type:"GET_SUBREDDIT",payload:r}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(2),console.error(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.fetchSubredditPosts,a=e.fetchSubreddits,c=e.fetchSubreddit,s=e.fetchUsers,i=e.fetchVotes,o=e.deletePost,m=(e.deleteSubreddit,e.subreddits),u=m.subreddits,p=m.subreddit,f=(m.isLoading,e.auth),v=f.currentUser,b=f.isLoggedIn,E=e.users.users,h=e.votes.votes,g=e.posts.posts,N=Object(l.h)();Object(l.g)();Object(n.useEffect)((function(){c(N),a(),s(),i()}),[c,a,s,i,N]),Object(n.useEffect)((function(){null!==p&&t(p.id)}),[t,p]);var O=Object(n.useState)(!1),_=Object(d.a)(O,2),y=_[0],j=_[1],x=Object(n.useState)(""),w=Object(d.a)(x,2),C=w[0],U=w[1];return r.a.createElement("section",null,r.a.createElement(k,{small:!0},r.a.createElement("div",{className:"hero-body",style:{backgroundColor:"black",color:"white"}},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"title is-capitalized",style:{color:"white"}},"Inscriptions of Temple Sacrifice"),r.a.createElement("h4",{style:{fontWeight:300,color:"white",lineHeight:1.3}},"Cast Votes on Temple Offerings to Help Templars",r.a.createElement("br",null),"Discover Top Fire Ritual Candidates")))),r.a.createElement(S,null,b?r.a.createElement("button",{className:"button is-primary",onClick:function(){return j(!y)}},y?"Cancel":"Inscribe an Offering"):r.a.createElement("div",null,"Sign In to Inscribe an Offering"),y&&r.a.createElement(le,{toggleShowForm:j,subreddit:p}),r.a.createElement("form",{className:"form"},r.a.createElement("div",{className:"control",style:{width:400}},r.a.createElement("input",{type:"text",className:"input search-box",placeholder:"Search",value:C,onChange:function(e){return function(e){U(e.target.value)}(e)}}))),0!==g.length&&null!==p&&r.a.createElement(ne,{users:E,votes:h,search:C,subreddit:p.name,subreddit_id:p.id,deletePost:o,posts:g,currentUser:v,subreddits:u})))})),me=a(72),ue=function(e){if(void 0===e)return"New Comment!";var t=1e3*e;return Object(me.a)(new Date(t),"MM-dd-yyyy HH:mm")},de=Object(p.b)(null,{updatePost:function(e,t){return function(){var a=Object(E.a)(b.a.mark((function a(n){var r,c;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,(r=Object(f.a)({},t)).updated_at=u.firestore.FieldValue.serverTimestamp(),a.next=5,g.collection("posts").doc(e).update(r);case 5:return a.next=7,g.collection("posts").doc(e).get().then((function(e){c=e.data()}));case 7:n({type:"CLEAR_POST"}),n({type:"UPDATE_POST",payload:c}),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),console.error(a.t0.message);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})));return function(e){return a.apply(this,arguments)}}()}})((function(e){var t=e.updatePost,a=e.toggleShowForm,c=e.oldTitle,s=e.oldDesc,i=e.oldUrl,l=e.oldImage,o=e.oldFileRef,m=e.post_id,u=Object(n.useState)({title:c,desc:s,url:i,image:l,fileRef:o}),p=Object(d.a)(u,2),v=p[0],b=p[1],E=v.title,h=v.desc,g=v.url,N=v.image,O=v.fileRef,_=Object(n.useState)(!1),y=Object(d.a)(_,2),j=y[0],x=y[1],w=Object(n.useState)(null),C=Object(d.a)(w,2),k=C[0],U=C[1],S=Object(n.useState)(!1),T=Object(d.a)(S,2),R=T[0],L=T[1],D=function(e){b(Object(f.a)(Object(f.a)({},v),{},Object(re.a)({},e.target.name,e.target.value)))};return r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault();var n,r=g,c=N,s=O;if(""!==O){var i=q(O);n=J.ref().child(i)}""!==c&&(ce(c)?(r="",s="",""!==O&&n.delete()):(r=c,s="",""!==O&&n.delete())),""!==r&&(s="",c="",""!==O&&n.delete()),""!==s&&(c="",r=""),t(m,{image:c,url:r,id:m,title:E,fileRef:s,desc:h}),a(!1)}(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"Title",type:"text",value:E,name:"title",required:!0,onChange:function(e){return D(e)}}))),r.a.createElement("button",{type:"button",className:"button is-info is-small mb-3",onClick:function(){return x(!j)}},j?"Hide Preview":"Preview Description"),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},j?r.a.createElement("div",{className:"preview-markdown"},r.a.createElement(z,null,h)):r.a.createElement("textarea",{className:"textarea",placeholder:"Desc",type:"text",value:h,name:"desc",onChange:function(e){return D(e)}}))),r.a.createElement("button",{type:"button",className:"button is-small mb-3 is-link",onClick:function(){return L(!R)}},R?"Add URL":"Upload Image"),R?r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{disabled:0!==g.length||0!==N.length,type:"file",onChange:function(e){return function(e){var t=e.target.files[0];t&&ce(t.type)&&U(t)}(e)}}),r.a.createElement("div",null,k&&r.a.createElement(ie,{file:k,setImageFile:U,input:v,setInput:b}))),r.a.createElement("p",{className:"help"},"You will ",r.a.createElement("span",{className:"has-text-weight-bold"},"delete")," your upload if you add a URL.")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"URL",type:"text",value:g,name:"url",onChange:function(e){return D(e)},disabled:0!==N.length})),r.a.createElement("p",{className:"help"},"You may only link to an image ",r.a.createElement("span",{className:"has-text-weight-bold"},"or")," a website")),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",placeholder:"Image",type:"text",value:N,name:"image",onChange:function(e){return D(e)},disabled:0!==g.length})),r.a.createElement("p",{className:"help"},"You may only link to an image ",r.a.createElement("span",{className:"has-text-weight-bold"},"or")," a website"))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary"},"Update Post")))})),pe=function(e){var t=e.addComment,a=e.currentUser,c=e.subreddit_id,s=e.post_id,i=Object(n.useState)(!1),l=Object(d.a)(i,2),o=l[0],m=l[1],u=Object(n.useState)({content:""}),p=Object(d.a)(u,2),v=p[0],b=p[1],E=v.content;return r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault();var n=a.id,r=Object(f.a)(Object(f.a)({},v),{},{user_id:n,post_id:s,subreddit_id:c,parent_id:null});t(r),b({content:""})}(e)}},r.a.createElement("button",{type:"button",className:"button is-info is-small mb-3",onClick:function(){return m(!o)}},o?"Hide Preview":"Preview Description"),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},o?r.a.createElement("div",{className:"preview-markdown"},r.a.createElement(z,null,E)):r.a.createElement("textarea",{className:"textarea",placeholder:"Comment",type:"text",value:E,name:"content",onChange:function(e){return function(e){b(Object(f.a)(Object(f.a)({},v),{},Object(re.a)({},e.target.name,e.target.value)))}(e)}}))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary"},"Comment")))},fe=function(e){var t=e.currentUser,a=e.toggleReplyForm,c=e.subreddit_id,s=e.comment_id,i=e.addComment,l=e.post_id,o=Object(n.useState)(!1),m=Object(d.a)(o,2),u=m[0],p=m[1],v=Object(n.useState)({content:""}),b=Object(d.a)(v,2),E=b[0],h=b[1],g=E.content;return r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault();var n=t.id,r=Object(f.a)(Object(f.a)({},E),{},{user_id:n,post_id:l,subreddit_id:c,parent_id:s});i(r),h({content:""}),a(!1)}(e)}},r.a.createElement("button",{type:"button",className:"button is-info is-small mb-3",onClick:function(){return p(!u)}},u?"Hide Preview":"Preview Description"),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},u?r.a.createElement("div",{className:"preview-markdown"},r.a.createElement(z,null,g)):r.a.createElement("textarea",{className:"textarea",placeholder:"Comment",type:"text",value:g,name:"content",onChange:function(e){return function(e){h(Object(f.a)(Object(f.a)({},E),{},Object(re.a)({},e.target.name,e.target.value)))}(e)}}))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary is-small"},"Comment")))},ve=function(e){var t=e.comment_id,a=e.oldContent,c=e.updateComment,s=e.toggleUpdateForm,i=Object(n.useState)(!1),l=Object(d.a)(i,2),o=l[0],m=l[1],u=Object(n.useState)({content:a}),p=Object(d.a)(u,2),v=p[0],b=p[1],E=v.content;return r.a.createElement("form",{className:"post-form",onSubmit:function(e){return function(e){e.preventDefault(),c({content:E,id:t}),s(!1)}(e)}},r.a.createElement("button",{type:"button",className:"button is-info is-small mb-3",onClick:function(){return m(!o)}},o?"Hide Preview":"Preview Description"),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},o?r.a.createElement("div",{className:"preview-markdown"},r.a.createElement(z,null,E)):r.a.createElement("textarea",{className:"textarea",placeholder:"Comment",type:"text",value:E,name:"content",onChange:function(e){return function(e){b(Object(f.a)(Object(f.a)({},v),{},Object(re.a)({},e.target.name,e.target.value)))}(e)}}))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary is-small"},"Update")))},be=function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=g.collection("comments").doc(),(r=Object(f.a)({},e)).id=n.id,r.created_at=u.firestore.FieldValue.serverTimestamp(),r.updated_at=u.firestore.FieldValue.serverTimestamp(),t.prev=5,t.next=8,g.collection("comments").doc(r.id).set(r);case 8:a({type:"ADD_COMMENT",payload:r}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),console.error(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[5,11]])})));return function(e){return t.apply(this,arguments)}}()},Ee=function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(r=Object(f.a)({},e)).updated_at=u.firestore.FieldValue.serverTimestamp(),t.next=5,g.collection("comments").doc(r.id).update(r);case 5:return t.next=7,g.collection("comments").doc(r.id).get().then((function(e){n=e.data()}));case 7:a({type:"UPDATE_COMMENT",payload:n}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.error(t.t0.message);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}()},he=function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.collection("comments").doc(e).delete();case 3:a({type:"DELETE_COMMENT",payload:e}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0.message);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},ge=Object(p.b)(null,{updateComment:Ee,deleteComment:he})((function(e){var t=e.updateComment,a=e.deleteComment,c=e.comment,s=e.currentUser,i=Object(n.useState)(!1),l=Object(d.a)(i,2),o=l[0],m=l[1],u={name:"Anonymous",image:"https://bulma.io/images/placeholders/96x96.png"};return void 0!==c.author&&(u.name=c.author.name,u.image=c.author.image),r.a.createElement("div",{className:"media my-2"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image"},r.a.createElement("img",{alt:"user avatar",src:u.image}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"has-text-weight-bold"},u.name),r.a.createElement("p",null,c.content),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item is-size-7"},r.a.createElement("span",{className:"created-at mr-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Created on:")," ",ue(c.created_at.seconds)),r.a.createElement("span",{className:"updated-at ml-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Updated on:")," ",ue(c.updated_at.seconds))))),s.id===c.user_id&&r.a.createElement("button",{className:"button is-warning is-small",onClick:function(){return m(!o)}},"Edit"),o&&r.a.createElement(ve,{comment_id:c.id,oldContent:c.content,updateComment:t,toggleUpdateForm:m})),s.id===c.user_id&&r.a.createElement("button",{onClick:function(){return a(c.id)},className:"delete"},"X"))})),Ne=Object(p.b)(null,{addComment:be,updateComment:Ee,deleteComment:he})((function(e){var t,a=e.currentUser,c=e.isLoggedIn,s=e.deleteComment,i=e.addComment,l=e.updateComment,o=e.users,m=e.comment,u=e.comments,p=Object(n.useState)(!1),f=Object(d.a)(p,2),v=f[0],b=f[1],E=Object(n.useState)(!1),h=Object(d.a)(E,2),g=h[0],N=h[1],O=(t=m.user_id,o.filter((function(e){return e.id===t})))[0],_=[];_=function(e){var t=u.filter((function(t){return t.parent_id===e}));return t.map((function(e){e.author=o.filter((function(t){return t.id===e.user_id}))[0]})),t}(m.id);return r.a.createElement("div",{className:"comment my-2"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left"},r.a.createElement("figure",{className:"image"},r.a.createElement("img",{alt:"Author avatar",src:void 0!==O&&O.image}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"has-text-weight-bold"},void 0!==O&&O.name),r.a.createElement(z,null,m.content),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item is-size-7"},r.a.createElement("span",{className:"created-at mr-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Created on:")," ",ue(m.created_at.seconds)),r.a.createElement("span",{className:"updated-at ml-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Updated on:")," ",ue(m.updated_at.seconds))))),c&&r.a.createElement("button",{className:"button is-primary is-small",onClick:function(){return g&&N(!1),void b(!v)}},"Reply"),a.id===m.user_id&&r.a.createElement("button",{className:"button is-warning is-small",onClick:function(){return v&&b(!1),void N(!g)}},"Edit"),v&&r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-content"},r.a.createElement(fe,{addComment:i,currentUser:a,subreddit_id:m.subreddit_id,comment_id:m.id,post_id:m.post_id,toggleReplyForm:b}))),g&&r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-content"},r.a.createElement(ve,{updateComment:l,comment_id:m.id,toggleUpdateForm:N,oldContent:m.content}))),0!==_.length&&void 0!==_[0].author&&_.map((function(e){return r.a.createElement(ge,{key:e.id,comment:e,currentUser:a})}))),a.id===m.user_id&&r.a.createElement("div",{className:"media-right"},r.a.createElement("button",{className:"delete",onClick:function(){return s(m.id)}},"X"))))})),Oe=Object(p.b)(null,{updateComment:Ee,deleteComment:he})((function(e){var t=e.updateComment,a=e.deleteComment,c=e.comment,s=e.currentUser,l=Object(n.useState)(!1),o=Object(d.a)(l,2),m=o[0],u=o[1],p={id:"st1llw0rk1ng",name:"Anonymous",image:"https://bulma.io/images/placeholders/96x96.png"};return void 0!==c.author&&(p.name=c.author.name,p.image=c.author.image),r.a.createElement("div",{className:"card mobile-card",style:{width:"92%"}},r.a.createElement("div",{className:"card-header"},r.a.createElement("span",{className:"card-header-title"},r.a.createElement("figure",{className:"mb-0 mr-3 image is-24x24"},r.a.createElement("img",{alt:"",className:"is-rounded",src:p.image})),r.a.createElement(i.b,{to:"/u/".concat(p.id)},p.name))),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"content"},r.a.createElement(z,null,c.content),r.a.createElement("p",{className:"is-size-7 mt-3 mb-0"},r.a.createElement("span",{className:"is-italic"},"Created")," ",ue(c.created_at.seconds)),r.a.createElement("p",{className:"is-size-7 mt-0 mb-0"},r.a.createElement("span",{className:"is-italic"},"Updated")," ",ue(c.updated_at.seconds)))),s.id===c.user_id&&r.a.createElement("div",{className:"card-footer",style:{flexDirection:"column",alignItems:"center"}},r.a.createElement("button",{className:"button is-warning is-small",style:{width:"100%"},onClick:function(){return u(!m)}},"Edit"),m&&r.a.createElement(ve,{updateComment:t,oldContent:c.content,toggleUpdateForm:u,comment_id:c.id})),s.id===c.user_id&&r.a.createElement("button",{className:"delete-button",onClick:function(){return a(c.id)}},"X"))})),_e=Object(p.b)(null,{addComment:be,updateComment:Ee,deleteComment:he})((function(e){var t=e.addComment,a=e.updateComment,c=e.deleteComment,s=e.isLoggedIn,l=e.currentUser,o=e.comment,m=e.users,u=e.comments,p=Object(n.useState)(!1),f=Object(d.a)(p,2),v=f[0],b=f[1],E=Object(n.useState)(!1),h=Object(d.a)(E,2),g=h[0],N=h[1],O=R(m,o.user_id),_=[];_=function(e){var t=u.filter((function(t){return t.parent_id===e}));return t.map((function(e){e.author=R(m,e.user_id)})),t}(o.id);return r.a.createElement("div",{className:"card mobile-card"},void 0!==O&&r.a.createElement("div",{className:"card-header"},r.a.createElement("span",{className:"card-header-title"},r.a.createElement("figure",{className:"mb-0 mr-3 image is-24x24"},r.a.createElement("img",{className:"is-rounded",alt:"",src:O.image})),r.a.createElement(i.b,{to:"/u/".concat(O.id)},O.name))),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"content"},r.a.createElement(z,null,o.content),r.a.createElement("p",{className:"is-size-7 mt-3 mb-0"},r.a.createElement("span",{className:"is-italic"},"Created")," ",ue(o.created_at.seconds)),r.a.createElement("p",{className:"is-size-7 mt-0 mb-0"},r.a.createElement("span",{className:"is-italic"},"Updated")," ",ue(o.updated_at.seconds)))),s&&r.a.createElement("footer",{className:"card-footer",style:{flexDirection:"column",alignItems:"center"}},r.a.createElement("button",{className:"button is-primary is-small",style:{width:"100%"},onClick:function(){return g&&N(!1),void b(!v)}},"Reply"),l.id===o.user_id&&r.a.createElement("button",{className:"button is-warning is-small",style:{width:"100%"},onClick:function(){return v&&b(!1),void N(!g)}},"Edit"),v&&r.a.createElement(fe,{addComment:t,currentUser:l,subreddit_id:o.subreddit_id,comment_id:o.id,post_id:o.post_id,toggleReplyForm:b}),g&&r.a.createElement(ve,{comment_id:o.id,oldContent:o.content,toggleUpdateForm:N,updateComment:a}),0!==_.length&&void 0!==_[0].author&&_.map((function(e){return r.a.createElement(Oe,{key:e.id,comment:e,currentUser:l,deleteComment:c})}))),l.id===o.user_id&&r.a.createElement("button",{className:"delete-button",onClick:function(){return c(o.id)}},"X"))})),ye=Object(p.b)((function(e){return{subreddits:e.subreddits,comments:e.comments,users:e.users,posts:e.posts,auth:e.auth,votes:e.votes}}),{fetchPost:function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n,r,c;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a({type:"CLEAR_POST"}),t.prev=1,n={},t.next=5,g.collection("posts").doc(e).get().then((function(e){n=e.data()}));case 5:return r=n.user_id,t.next=8,g.collection("users").doc(r).get().then((function(e){n.author=e.data()}));case 8:return n.comments=[],t.next=11,g.collection("comments").where("post_id","==",e).get();case 11:return c=t.sent,t.next=14,c.forEach((function(e){n.comments.push(e.data())}));case 14:a({type:"GET_POST",payload:n}),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),console.error(t.t0.message);case 20:case"end":return t.stop()}}),t,null,[[1,17]])})));return function(e){return t.apply(this,arguments)}}()},fetchUsers:ee,fetchPostVote:function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,g.collection("votes").where("post_id","==",e).get();case 3:t.sent.forEach((function(e){n=e.data()})),a({type:"CLEAR_VOTE"}),a({type:"GET_VOTE",payload:n}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()},fetchSubreddits:O,fetchPostComments:function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],t.prev=1,a({type:"CLEAR_COMMENTS"}),t.next=5,g.collection("comments").where("post_id","==",e).get();case 5:t.sent.forEach((function(e){n.push(e.data())})),n=n.sort((function(e,t){return t.created_at-e.created_at})),a({type:"GET_COMMENTS",payload:n}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.error(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}()},addComment:be,deletePost:Q,upvote:H,downvote:X})((function(e){var t=e.fetchPost,a=e.fetchUsers,c=e.fetchPostVote,s=e.fetchSubreddits,o=e.fetchPostComments,m=e.addComment,u=e.deletePost,p=e.upvote,f=e.downvote,v=e.votes.vote,b=e.posts.post,E=e.users.users,h=e.auth,g=h.currentUser,N=h.isLoggedIn,O=e.subreddits.subreddits,_=e.comments.comments,y=Object(l.g)(),j=Object(l.h)(),x=j.post_id,w=j.name;Object(n.useEffect)((function(){t(x),s(),o(x),a(),c(x)}),[s,o,c,a,t,x]);var C,T=Object(n.useState)(!1),L=Object(d.a)(T,2),D=L[0],I=L[1];0!==O.length&&(C=R(O,w,"name").id);var A,F,M={name:"Anonymous",url:"",image:"https://bulma.io/images/placeholders/96x96.png",id:"rand0mnumb3rgen3r4t0r"};return null!==b&&(M=R(E,b.user_id)),null!==b&&(""!==b.image?(A=b.image,F=b.image):""!==b.fileRef?(A=b.fileRef,F=b.fileRef):""!==b.url?(A=P.a,F=b.url):(A=V.a,F="#!")),r.a.createElement("section",null,r.a.createElement(k,{medium:!0,color:"light"},r.a.createElement("div",{className:"hero-head mt-3",style:{marginLeft:"auto",marginRight:"auto"}},r.a.createElement("button",{className:"button is-success is-small ".concat(null!==v&&-1!==v.user_upvotes.indexOf(g.id)&&"is-light"),disabled:0===Object.entries(g).length,onClick:function(){return p(v.id,x,g.id,!0)}},"Upvote"),null!==v&&r.a.createElement("span",{className:"mx-3"},v.votes),r.a.createElement("button",{className:"button is-danger is-small ".concat(null!==v&&-1!==v.user_downvotes.indexOf(g.id)&&"is-light"),disabled:0===Object.entries(g).length,onClick:function(){return f(v.id,x,g.id,!0)}},"Downvote")),r.a.createElement("div",{className:"hero-body post-hero-body"},null!==b&&r.a.createElement("figure",{className:"image post-image"},r.a.createElement("a",{href:F,rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{src:A,alt:""}))),r.a.createElement("h1",{className:"title has-text-centered mb-5"},null!==b&&b.title),null!==b&&b.desc&&r.a.createElement("div",{className:"subtitle post-content mt-5"},r.a.createElement(z,null,b.desc))),r.a.createElement("div",{className:"hero-foot mb-3"},r.a.createElement("div",{className:"level is-size-7"},r.a.createElement("div",{className:"level-item has-text-centered mb-0"},r.a.createElement("figure",{className:"image is-24x24 mr-2",style:{marginBottom:0}},r.a.createElement("img",{className:"is-rounded",src:M.image,alt:""})),r.a.createElement(i.b,{to:"/u/".concat(M.id)},r.a.createElement("p",null,M.name))),r.a.createElement("div",{className:"level-item has-text-centered mt-0 mb-0"},r.a.createElement("p",null,"Created: ",null!==b&&ue(b.created_at.seconds))),r.a.createElement("div",{className:"level-item has-text-centered mt-0"},r.a.createElement("p",null,"Updated: ",null!==b&&ue(b.updated_at.seconds))),null!==b&&g.id===b.user_id&&r.a.createElement("div",{className:"level-item has-text-centered mb-0"},r.a.createElement("button",{className:"button is-small is-danger",onClick:function(){u(b.id,v.id),y.push("/")}},"Delete Post"))))),r.a.createElement(S,null,null!==b&&g.id===b.user_id&&r.a.createElement("button",{className:"button is-success",onClick:function(){return I(!D)}},D?"Close Form":"Edit Post"),D&&null!==b&&r.a.createElement(de,{oldImage:b.image,oldTitle:b.title,oldDesc:b.desc,oldUrl:b.url,oldFileRef:b.fileRef,post_id:b.id,toggleShowForm:I}),r.a.createElement("div",{className:"comments"},0!==_.length&&_.map((function(e){return null===e.parent_id&&(U.isMobile?r.a.createElement(_e,{key:e.id,users:E,comments:_,comment:e,currentUser:g,isLoggedIn:N}):r.a.createElement(Ne,{comment:e,comments:_,currentUser:g,isLoggedIn:N,users:E,key:e.id}))})),r.a.createElement("div",{className:"mt-3 comment-form"},r.a.createElement("h2",{className:"subtitle"},"Add a Comment"),r.a.createElement(pe,{addComment:m,currentUser:g,post_id:x,name:w,subreddit_id:C})))))})),je=function(e){var t,a,n=e.post,c=e.user,s=e.subreddit,l=e.currentUser,o=e.vote,m=e.deletePost;return""!==n.image?(t=n.image,a=n.image):""!==n.fileRef?(t=n.fileRef,a=n.fileRef):""!==n.url?(t=P.a,a=n.url):(t=V.a,a="/r/".concat(s.name,"/").concat(n.id)),r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left align-center"},r.a.createElement("a",{href:a,rel:"noopener noreferrer",target:"_blank"},r.a.createElement("figure",{className:"image is-128x128 center-image border-image"},r.a.createElement("img",{src:t,alt:""})))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"has-text-weight-bold"},void 0!==s&&r.a.createElement(i.b,{to:"/r/".concat(s.name,"/").concat(n.id)},n.title)),n.desc&&r.a.createElement("div",{className:"mb-3"},r.a.createElement(z,null,L(n.desc))),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item"},r.a.createElement("p",{className:"is-size-7"},void 0!==s&&r.a.createElement(i.b,{to:"/r/".concat(s.name)},s.name)))))),null!==c&&c.id===l.id&&r.a.createElement("div",{className:"media-right"},r.a.createElement("button",{className:"delete",onClick:function(){return m(n.id,o.id)}},"X"))))},xe=function(e){var t=e.comment,a=e.user,n=e.currentUser,c=e.deleteComment;return r.a.createElement("div",{className:"box"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left align-center"},r.a.createElement("figure",{className:"image is-64x64 center-image"},r.a.createElement("img",{src:a.image,alt:"user avatar"}))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"has-text-weight-bold"},a.name),r.a.createElement("div",{className:"mb-3"},r.a.createElement(z,null,t.content)),r.a.createElement("div",{className:"level"},r.a.createElement("div",{className:"level-left"},r.a.createElement("div",{className:"level-item is-size-7"},r.a.createElement("span",{className:"created-at mr-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Created on:")," ",ue(t.created_at.seconds)),r.a.createElement("span",{className:"updated-at ml-2"},r.a.createElement("span",{className:"has-text-weight-bold"},"Updated on:")," ",ue(t.updated_at.seconds)))))),null!==a&&a.id===n.id&&r.a.createElement("div",{className:"media-right"},r.a.createElement("button",{className:"delete",onClick:function(){return c(t.id)}},"X"))))},we=function(e){var t=e.comment,a=e.user,n=e.currentUser,c=e.deleteComment;return r.a.createElement("div",{className:"card mobile-card"},void 0!==a&&r.a.createElement("div",{className:"card-header"},r.a.createElement("span",{className:"card-header-title"},r.a.createElement("figure",{className:"mb-0 mr-3 image is-24x24"},r.a.createElement("img",{className:"is-rounded",alt:"",src:a.image})),a.name)),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"content"},r.a.createElement(z,null,t.content),r.a.createElement("p",{className:"is-size-7 mt-3 mb-0"},r.a.createElement("span",{className:"is-italic"},"Created")," ",ue(t.created_at.seconds)),r.a.createElement("p",{className:"is-size-7 mt-0 mb-0"},r.a.createElement("span",{className:"is-italic"},"Updated")," ",ue(t.updated_at.seconds)))),null!==a&&a.id===n.id&&r.a.createElement("button",{className:"delete-button",onClick:function(){return c(t.id)}},"X"))},Ce=function(e){var t,a,n=e.post,c=e.user,s=e.subreddit,l=e.currentUser,o=e.vote,m=e.deletePost;return""!==n.image?(t=n.image,a=n.image):""!==n.fileRef?(t=n.fileRef,a=n.fileRef):""!==n.url?(t=P.a,a=n.url):(t=V.a,a="/r/".concat(s.name,"/").concat(n.id)),r.a.createElement("div",{className:"card mobile-card"},void 0!==n&&r.a.createElement("div",{className:"card-image"},r.a.createElement("figure",{className:"image is-4by3"},r.a.createElement("a",{href:a,rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{src:t,alt:""})))),r.a.createElement("div",{className:"card-content"},r.a.createElement("p",{className:"mt-0 mb-0"},void 0!==s&&r.a.createElement(i.b,{to:"/r/".concat(s.name,"/").concat(n.id)},n.title)),n.desc&&r.a.createElement("p",{className:"mt-0 mb-0"},n.desc)),null!==c&&c.id===l.id&&r.a.createElement("button",{className:"delete-button",onClick:function(){return m(n.id,o.id)}},"X"))},ke=Object(p.b)((function(e){return{users:e.users,auth:e.auth,posts:e.posts,votes:e.votes,subreddits:e.subreddits,comments:e.comments}}),{deletePost:Q,deleteComment:he,fetchUser:function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"CLEAR_USER"}),t.next=4,g.collection("users").doc(e).get().then((function(e){n=e.data()}));case 4:a({type:"GET_USER",payload:n}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},fetchVotes:B,fetchUserPosts:function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"CLEAR_POSTS"}),n=[],t.next=5,g.collection("posts").where("user_id","==",e).get();case 5:t.sent.forEach((function(e){n.push(e.data())})),n=n.sort((function(e,t){return t.created_at-e.created_at})),a({type:"GET_POSTS",payload:n}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0.message);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e){return t.apply(this,arguments)}}()},fetchSubreddits:O,fetchUserComments:function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],t.prev=1,a({type:"CLEAR_COMMENTS"}),t.next=5,g.collection("comments").where("user_id","==",e).get();case 5:t.sent.forEach((function(e){n.push(e.data())})),n=n.sort((function(e,t){return t.created_at-e.created_at})),a({type:"GET_COMMENTS",payload:n}),t.next=13;break;case 11:t.prev=11,t.t0=t.catch(1);case 13:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}()}})((function(e){var t=e.deletePost,a=e.deleteComment,c=e.fetchUser,s=e.fetchVotes,i=e.fetchUserPosts,o=e.fetchUserComments,m=e.fetchSubreddits,u=e.posts,p=u.posts,f=u.isLoading,v=e.comments.comments,b=e.users,E=b.user,h=(b.users,e.auth.currentUser),g=e.subreddits.subreddits,N=e.votes.votes,O=Object(l.h)().user_id;Object(n.useEffect)((function(){c(O),i(O),o(O),m(),s()}),[i,m,o,s,c,O]);var _=Object(n.useState)(!0),y=Object(d.a)(_,2),j=y[0],x=y[1],w=Object(n.useState)(!1),C=Object(d.a)(w,2),k=C[0],T=C[1];return r.a.createElement("section",null,r.a.createElement("div",{className:"hero is-primary mb-5"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container has-text-centered"},r.a.createElement("figure",{className:"image is-32x32",style:{margin:"0 auto"}},r.a.createElement("img",{src:null!==E&&E.image&&E.image,alt:"User avatar"})),r.a.createElement("h1",{className:"title"},null!==E&&E.name),null!==E&&""!==E.bio&&r.a.createElement("h2",{className:"subtitle"},E.bio)))),r.a.createElement(S,null,r.a.createElement("div",{className:"buttons my-2"},r.a.createElement("button",{className:"button is-small is-info ".concat(j&&"is-light"),disabled:j,onClick:function(){return x(!0),void T(!1)}},"User Posts"),r.a.createElement("button",{className:"button is-small is-warning ".concat(k&&"is-light"),disabled:k,onClick:function(){return T(!0),void x(!1)}},"User Comments")),j&&r.a.createElement("div",{className:"user-posts"},0!==p.length&&!f&&p.map((function(e){var a=R(N,e.id,"post_id"),n=R(g,e.subreddit_id);return U.isMobile?r.a.createElement(Ce,{key:e.id,post:e,user:E,subreddit:n,currentUser:h,vote:a,deletePost:t}):r.a.createElement(je,{key:e.id,vote:a,subreddit:n,currentUser:h,deletePost:t,user:E,post:e})}))),k&&r.a.createElement("div",{className:"user-comments"},0!==v.length&&!f&&v.map((function(e){return U.isMobile?r.a.createElement(we,{key:e.id,comment:e,user:E,currentUser:h,deleteComment:a}):r.a.createElement(xe,{key:e.id,comment:e,user:E,currentUser:h,deleteComment:a})})))))})),Ue=function(e){var t,a,n=e.subreddit,c=e.post;return""!==c.image?(t=c.image,a=c.image):""!==c.fileRef?(t=c.fileRef,a=c.fileRef):""!==c.url?(t=P.a,a=c.url):(t=V.a,a="/r/".concat(n.name,"/").concat(c.id)),r.a.createElement("div",{className:"column is-4 post-column"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("p",{className:"is-capitalized card-header-title"},r.a.createElement(i.b,{to:"/r/".concat(n.name)},n.name))),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"media"},r.a.createElement("div",{className:"media-left align-center"},r.a.createElement("a",{href:a,rel:"noopener noreferrer",target:"_blank"},r.a.createElement("figure",{className:"image is-128x128 center-image border-image"},r.a.createElement("img",{src:t,alt:""})))),r.a.createElement("div",{className:"media-content"},r.a.createElement("p",{className:"title is-4"},r.a.createElement(i.b,{to:"/r/".concat(n.name,"/").concat(c.id)},c.title)))),c.desc&&r.a.createElement("div",{className:"content"},r.a.createElement(z,null,L(c.desc))))))},Se=function(e){var t,a,n=e.subreddit,c=e.post;return""!==c.image?(t=c.image,a=c.image):""!==c.fileRef?(t=c.fileRef,a=c.fileRef):""!==c.url?(t=P.a,a=c.url):(t=V.a,a="/r/".concat(n.name,"/").concat(c.id)),r.a.createElement("div",{className:"column post-column"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("p",{className:"is-capitalized card-header-title"},r.a.createElement(i.b,{to:"/r/".concat(n.name)},n.name))),r.a.createElement("div",{className:"card-image"},r.a.createElement("figure",{className:"image is-4by3"},r.a.createElement("a",{href:a,rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{src:t,alt:""})))),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"content"},r.a.createElement("p",{className:"title is-6"},r.a.createElement(i.b,{to:"/r/".concat(n.name,"/").concat(c.id)},c.title)),c.desc&&r.a.createElement("div",{className:"mb-3"},r.a.createElement(z,null,L(c.desc)))))))},Te=Object(p.b)((function(e){return{subreddits:e.subreddits,posts:e.posts}}),{fetchSubreddits:O,fetchAllPosts:K})((function(e){var t=e.fetchSubreddits,a=e.fetchAllPosts,c=e.posts.posts,s=e.subreddits.subreddits;return Object(n.useEffect)((function(){t(),a()}),[t,a]),r.a.createElement("section",null,r.a.createElement("div",{className:"hero is-warning is-medium"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container"},r.a.createElement("h1",{className:"title"},"Subreddits"),r.a.createElement("h2",null,"See the latest from each Subreddit")))),r.a.createElement(S,null,r.a.createElement("div",{className:"columns is-multiline is-4"},0!==s.length&&s.map((function(e){var t=R(c,e.id,"subreddit_id");return void 0===t&&(t={title:"Nothing here yet!",url:"",image:"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a2/VisualEditor_-_Icon_-_Link.svg/768px-VisualEditor_-_Icon_-_Link.svg.png",user_id:"none",subreddit_id:e.id,id:"none",desc:"Be the first to post in this subreddit!",created_at:{seconds:0,nanoseconds:0},updated_at:{seconds:0,nanoseconds:0}}),U.isMobile?r.a.createElement(Se,{key:e.id,subreddit:e,post:t}):r.a.createElement(Ue,{key:e.id,subreddit:e,post:t})})))))})),Re=Object(p.b)((function(e){return{auth:e.auth}}),{createSubreddit:function(e,t){return function(){var a=Object(E.a)(b.a.mark((function a(n){var r,c;return b.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,r=g.collection("subreddits").doc(),(c=Object(f.a)({},e)).id=r.id,c.created_at=u.firestore.FieldValue.serverTimestamp(),a.next=7,g.collection("subreddits").doc(c.id).set(c);case 7:n({type:"CREATE_SUBREDDIT",payload:c}),t&&t.push("/r/".concat(c.name)),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),console.error(a.t0.message);case 14:case"end":return a.stop()}}),a,null,[[0,11]])})));return function(e){return a.apply(this,arguments)}}()}})((function(e){var t=e.createSubreddit,a=e.auth.currentUser,c=Object(n.useState)(!1),s=Object(d.a)(c,2),i=s[0],o=s[1],m=Object(n.useState)({name:"",desc:"",color:"yellow"}),u=Object(d.a)(m,2),p=u[0],v=u[1],b=p.name,E=p.desc,h=p.color,g=Object(l.g)(),N=function(e){v(Object(f.a)(Object(f.a)({},p),{},Object(re.a)({},e.target.name,e.target.value)))};return r.a.createElement(S,null,r.a.createElement("h1",{className:"has-text-centered is-title"},"Create a Subreddit"),r.a.createElement("form",{className:"create-sub-form",onSubmit:function(e){return function(e){e.preventDefault();var n=a.id,r=p.name.toLowerCase(),c={name:r=r.replaceAll(/\W/g,""),desc:p.desc,user_id:n,color:h};t(c,g),v({name:"",desc:"",color:""})}(e)}},r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("label",{className:"label"},"Name"),r.a.createElement("input",{className:"input",type:"text",name:"name",value:b,placeholder:"Name the Subreddit",onChange:function(e){return N(e)},maxLength:"20"}))),r.a.createElement("button",{type:"button",className:"button is-info is-small mb-3",onClick:function(){return o(!i)}},i?"Hide Preview":"Preview Description"),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("label",{className:"label"},"Description"),i?r.a.createElement("div",{className:"preview-markdown"},r.a.createElement(z,null,E)):r.a.createElement("textarea",{className:"textarea",placeholder:"Desc",type:"text",value:E,name:"desc",onChange:function(e){return N(e)}}))),r.a.createElement("div",{className:"field"},r.a.createElement("div",{className:"control"},r.a.createElement("label",{className:"label"},"Color"),r.a.createElement("div",{className:"select"},r.a.createElement("select",{name:"color",onChange:function(e){return N(e)}},r.a.createElement("option",{selected:!0,value:"yellow"},"Yellow"),r.a.createElement("option",{value:"dark"},"Black"),r.a.createElement("option",{value:"light"},"Light gray"),r.a.createElement("option",{value:"lightblue"},"Light blue"),r.a.createElement("option",{value:"darkblue"},"Dark blue"),r.a.createElement("option",{value:"teal"},"Teal"),r.a.createElement("option",{value:"green"},"Green"))))),r.a.createElement("div",{className:"control"},r.a.createElement("button",{className:"button is-primary"},"Create Subreddit"))))})),Le=a(43),De=a(22),Pe=a(11),Ie={users:[],user:null,isLoading:!0},Ve={currentUser:{},isLoggedIn:!1,isLoading:!0},Ae={posts:[],post:null,isLoading:!0},Fe={subreddits:[],subreddit:null,isLoading:!0},Me={comments:[],isLoading:!0},Ge={votes:[],vote:null,isLoading:!0},ze=Object(De.combineReducers)({users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ie,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_USERS":return Object(f.a)(Object(f.a)({},e),{},{users:Object(Pe.a)(n),isLoading:!1});case"GET_USER":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,user:n});case"CLEAR_USER":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,user:null});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"LOGIN_USER":case"GET_CURRENT_USER":return Object(f.a)(Object(f.a)({},e),{},{currentUser:Object(f.a)({},n),isLoggedIn:!0,isLoading:!1});case"LOGOUT_USER":case"LOGIN_FAIL":return Object(f.a)(Object(f.a)({},e),{},{currentUser:{},isLoggedIn:!1,isLoading:!1});default:return e}},posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_POSTS":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,posts:Object(Pe.a)(n)});case"GET_POST":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,post:n});case"CREATE_POST":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,posts:[n].concat(Object(Pe.a)(e.posts))});case"UPDATE_POST":var r=e.posts.filter((function(e){return e.id!==n.id}));return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,posts:[].concat(Object(Pe.a)(r),[n]),post:n});case"DELETE_POST":var c=e.posts.filter((function(e){return e.id!==n}));return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,posts:Object(Pe.a)(c)});case"CLEAR_POST":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,post:null});case"CLEAR_POSTS":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,posts:[]});default:return e}},subreddits:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fe,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_SUBREDDITS":return Object(f.a)(Object(f.a)({},e),{},{subreddits:n,isLoading:!1});case"GET_SUBREDDIT":return Object(f.a)(Object(f.a)({},e),{},{subreddit:n,isLoading:!1});case"CREATE_SUBREDDIT":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,subreddits:[].concat(Object(Pe.a)(e.subreddits),[n])});case"UPDATE_SUBREDDIT":var r=e.subreddits.filter((function(e){return e.id!==n.id}));return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,subreddits:[].concat(Object(Pe.a)(r),[n])});case"DELETE_SUBREDDIT":var c=e.subreddits.filter((function(e){return e.id!==n}));return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,subreddits:Object(Pe.a)(c)});case"CLEAR_SUBREDDIT":return Object(f.a)(Object(f.a)({},e),{},{subreddit:null,isLoading:!1});default:return e}},comments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Me,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_COMMENTS":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,comments:n});case"ADD_COMMENT":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,comments:[].concat(Object(Pe.a)(e.comments),[n])});case"UPDATE_COMMENT":var r=e.comments.filter((function(e){return e.id!==n.id}));return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,comments:[].concat(Object(Pe.a)(r),[n])});case"DELETE_COMMENT":var c=e.comments.filter((function(e){return e.id!==n}));return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,comments:Object(Pe.a)(c)});case"CLEAR_COMMENTS":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,comments:[]});default:return e}},votes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"GET_VOTES":return Object(f.a)(Object(f.a)({},e),{},{votes:Object(Pe.a)(n),isLoading:!1});case"GET_VOTE":return Object(f.a)(Object(f.a)({},e),{},{vote:n,isLoading:!1});case"ADD_VOTES":return Object(f.a)(Object(f.a)({},e),{},{votes:[].concat(Object(Pe.a)(e.votes),[n]),isLoading:!1});case"ADD_VOTE":var r=e.votes.filter((function(e){return e.id!==n.id}));return Object(f.a)(Object(f.a)({},e),{},{votes:[].concat(Object(Pe.a)(r),[n]),isLoading:!1});case"REMOVE_VOTE":var c=e.votes.filter((function(e){return e.id!==n.id}));return Object(f.a)(Object(f.a)({},e),{},{votes:[].concat(Object(Pe.a)(c),[n]),isLoading:!1});case"DELETE_VOTE":var s=e.votes.filter((function(e){return e.id!==n}));return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,votes:Object(Pe.a)(s)});case"CLEAR_VOTE":return Object(f.a)(Object(f.a)({},e),{},{isLoading:!1,vote:null});default:return e}}}),Be=[a(44).a],He=Object(De.createStore)(ze,{},Object(Le.composeWithDevTools)(De.applyMiddleware.apply(void 0,Be)));var Xe=function(){return Object(n.useEffect)((function(){u.auth().onAuthStateChanged((function(e){if(e){var t={name:e.displayName,id:e.uid,image:e.photoURL};He.dispatch(function(e){return function(){var t=Object(E.a)(b.a.mark((function t(a){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"GET_CURRENT_USER",payload:e});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t))}else He.dispatch((function(e){e({type:"LOGIN_FAIL"})}))}))})),r.a.createElement(i.a,null,r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"content"},r.a.createElement(j,null),r.a.createElement(l.d,null,r.a.createElement(l.a,{exact:!0,from:"/",to:"/r/offerings",component:te}),r.a.createElement(C,{exact:!0,path:"/create-a-subreddit",component:Re}),r.a.createElement(l.b,{exact:!0,path:"/r/index",component:Te}),r.a.createElement(l.b,{exact:!0,path:"/r/:name",component:oe}),r.a.createElement(l.b,{exact:!0,path:"/r/:name/:post_id",component:ye}),r.a.createElement(l.b,{exact:!0,path:"/u/:user_id",component:ke})))),r.a.createElement(x,null))};s.a.render(r.a.createElement(p.a,{store:He},r.a.createElement(Xe,null)),document.getElementById("root"))}},[[47,1,2]]]);
//# sourceMappingURL=main.fc582a8c.chunk.js.map